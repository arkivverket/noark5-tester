Klargjør hvordan GET for ny-* -relasjoner fungerer
==================================================

 ------------------  ---------------------------------
           Prosjekt  NOARK 5 Tjenestegresesnitt
           Kategori  Versjon 1.0 beta
        Alvorlighet  kommentar
       Meldingstype  utelatt
    Brukerreferanse  pere@hungry.com
        Dokumentdel  6.1.1.3
         Sidenummer  16
        Linjenummer  n/a
    Innsendingsdato  ikke sendt inn
 ------------------  ---------------------------------

Denne teksten er del av en samling innspill til NOARK5-standarden
tilgjengelig fra [https://github.com/petterreinholdtsen/noark5-tester/](https://github.com/petterreinholdtsen/noark5-tester/).

Beskrivelse
-----------

Punkt 6.1.1.3 (Opprette objekter (Create)) på side 16 sier følgende om
GET av URL for oppretting av objekter (ny-*):

> GET forespørselen forhåndsutfyller en lovlig objektstruktur og gir
> relasjonslenker til aktuelle kodelister.

Det er uklart hva dette konkret betyr.  Vil en slik GET opprette et
nytt objekt der kun standardverdiene er satt, eller kun returnere en
mal som kan brukes til å opprette et objekt med POST?  Den virker
sannsynlig at den returnerer en mal, men det hadde vært fint om dette
kom klarere frem.

Hvis den returnerer en mal, så bør det stå om malen inneholde alle
felt som kan settes, kun de feltene som ikke fylles inn automatisk ved
oppretting eller kun de feltene som kan fylles inn automatisk ved
oppretting?  Det kommer ikke klart frem fra eksemplet for ny-mappe i
teksten.

Klassen Mappe inneholder følgende felter i følge punkt 7.2.1.16
(Mappe):

 * mappeID [0..1]
 * mappetype [0..1] (*)
 * tittel [1..1] (*)
 * offentliTittel [0..1]
 * beskrivelse [0..1]
 * nøkkelord [0..*]
 * dokumentmedium [0..1] (*)
 * oppbevaringssted [0..*]
 * avsluttetDato [0..1]
 * avsluttetAv [0..]
 * referanseAvsluttetAv [0..1]
 * kassasjon [0..1]
 * skjerming [0..1]
 * gradering [0..1]
 * referanseFolderMappe [0..1]
 * virksomhetsspesifikkeMetadata [0..1]

Men eksempelet for ny-mappe inneholder kun feltene markert med (*).
Hvorfor er kun disse med i eksempelet og ikke andre?  Det fremgår ikke
av spesifikasjonen.

Hvis en klient skal kunne automatisk oppdage hvilke felt som kan
settes ved oppretting, så er det best om alle felter er med i
resultatet fra GET her.  De som ikke kan forhåndsutfylles med rimelige
standardverdier kan f.eks. få verdien 'null' for å synliggjøre dette.
De feltene som ikke kan settes vha. POST bør ikke være med.
Resultatet fra ny-mappe kan da f.eks. se slik ut:

```
{
 "mappetype": {
   "kode": "BYGG",
   "beskrivelse": "Byggesak"
 },
 "tittel": "angi tittel på mappe",
 "offentliTittel": null,
 "beskrivelse": null,
 "nøkkelord null,
 "dokumentmedium": {
    "kode": "E",
    "beskrivelse": "Elektronisk arkiv"
 },
 "oppbevaringssted null,
 "referanseAvsluttetAv": null,
 "kassasjon": null,
 "skjerming": null,
 "gradering": null,
 "referanseFolderMappe": null,
 "virksomhetsspesifikkeMetadata": null,
 "_links": [ ... ]
}
```

Feltene mappeID, avsluttetDato og avsluttetAv er ikke med i denne
JSON-strukturen da spesifikasjonen sier disse registreres automatisk
av system og dermed antas å ikke kunne settes med POST.

Det går ikke klart frem av teksten om \_links-listen skal inneholde en
'self'-relasjon eller ikke.  Hvis det kun er en mal, virker det mest
rimelig at den ikke skal ha 'self'-relasjon, men det kan være greit å
nevne dette eksplisitt.

Ønsket endring
--------------

Foreslår å legge inn tekst etter "GET forespørselen forhåndsutfyller
en lovlig objektstruktur og gir relasjonslenker til aktuelle
kodelister." som sier at ingenting opprettes når en bruker GET, slik
at avsnitttet lyder:

> GET-forespørselen forhåndsutfyller en lovlig objektstruktur og gir
> relasjonslenker til aktuelle kodelister.  En slik forespørsel
> oppretter ingenting og refererer ikke heller til et objekt i
> database, og er dermed uten 'self'-relasjon. Strukturen (uten
> "\_links" og felt med verdi 'null') kan brukes som del av en POST
> når et nytt objekt skal opprettes.  Alle felt som kan brukes i POST
> for oppretting av nytt objekt er med i strukturen.  De feltene som
> ikke kan forhåndsutfylles automatisk har verdien 'null'.

I tillegg endres eksemplet på side 17 slik at alle mulige feltnavn i
Mappe er med, f.eks. slik det er vist frem i beskrivelsen.
